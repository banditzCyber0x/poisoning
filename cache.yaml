id: cache-poisoning-HIT
info:
  name: "RSC Cache Poisoning"
  author: banditz
  severity: info
variables:
  num: "{{rand_int(9000000, 9999999)}}"

http:
  - raw:
      - |
        GET /?test={{num}} HTTP/1.1
        Host: {{Hostname}}

    matchers:
      - type: word
        part: header
        words:
          - 'X-Nextjs-Cache: HIT'
        condition: and